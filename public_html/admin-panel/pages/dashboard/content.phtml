<?php
$this_start = strtotime("1 January " . date('Y') . " 12:00am");
$this_end = strtotime("31 December " . date('Y') . " 11:59pm");
$array = array('01' => 0, '02' => 0, '03' => 0, '04' => 0, '05' => 0, '06' => 0, '07' => 0, '08' => 0, '09' => 0, '10' => 0, '11' => 0, '12' => 0);
$code = 'm';
$main_range = 'This Year';
$title = "Yearly";
if (!empty($_GET['range']) && in_array($_GET['range'], array('Today', 'Yesterday', 'This Week', 'This Month', 'Last Month'))) {
    if ($_GET['range'] == 'Today' || $_GET['range'] == 'Yesterday') {
        $array = array('00' => 0, '01' => 0, '02' => 0, '03' => 0, '04' => 0, '05' => 0, '06' => 0, '07' => 0, '08' => 0, '09' => 0, '10' => 0, '11' => 0, '12' => 0, '13' => 0, '14' => 0, '15' => 0, '16' => 0, '17' => 0, '18' => 0, '19' => 0, '20' => 0, '21' => 0, '22' => 0, '23' => 0);
        $this_start = strtotime(date('M') . " " . date('d') . ", " . date('Y') . " 12:00am");
        $this_end = strtotime(date('M') . " " . date('d') . ", " . date('Y') . " 11:59pm");
        if ($_GET['range'] == 'Yesterday') {
            $this_start = strtotime(date('M') . " " . date('d', strtotime("-1 days")) . ", " . date('Y') . " 12:00am");
            $this_end = strtotime(date('M') . " " . date('d', strtotime("-1 days")) . ", " . date('Y') . " 11:59pm");
        }
        $code = 'H';
        $main_range = 'Today';
        $title = "Daily";
    } elseif ($_GET['range'] == 'This Week') {
        $time = strtotime(date('l') . ", " . date('M') . " " . date('d') . ", " . date('Y'));

        if (date('l') == 'Saturday') {
            $this_start = strtotime(date('M') . " " . date('d') . ", " . date('Y') . " 12:00am");
        } else {
            $this_start = strtotime('last saturday, 12:00am', $time);
        }

        if (date('l') == 'Friday') {
            $this_end = strtotime(date('M') . " " . date('d') . ", " . date('Y') . " 11:59pm");
        } else {
            $this_end = strtotime('next Friday, 11:59pm', $time);
        }

        $array = array('Saturday' => 0, 'Sunday' => 0, 'Monday' => 0, 'Tuesday' => 0, 'Wednesday' => 0, 'Thursday' => 0, 'Friday' => 0);
        $code = 'l';
        $main_range = 'This Week';
        $title = "Weekly";
    } elseif ($_GET['range'] == 'This Month' || $_GET['range'] == 'Last Month') {
        $this_start = strtotime("1 " . date('M') . " " . date('Y') . " 12:00am");
        $this_end = strtotime(cal_days_in_month(CAL_GREGORIAN, date('m'), date('Y')) . " " . date('M') . " " . date('Y') . " 11:59pm");
        $array = array_fill(1, cal_days_in_month(CAL_GREGORIAN, date('m'), date('Y')), 0);
        $month_days = cal_days_in_month(CAL_GREGORIAN, date('m'), date('Y'));
        if ($_GET['range'] == 'Last Month') {
            $this_start = strtotime("1 " . date('M', strtotime("-1 month")) . " " . date('Y') . " 12:00am");
            $this_end = strtotime(cal_days_in_month(CAL_GREGORIAN, date('m', strtotime("-1 month")), date('Y')) . " " . date('M', strtotime("-1 month")) . " " . date('Y') . " 11:59pm");
            $array = array_fill(1, cal_days_in_month(CAL_GREGORIAN, date('m', strtotime("-1 month")), date('Y')), 0);
            $month_days = cal_days_in_month(CAL_GREGORIAN, date('m', strtotime("-1 month")), date('Y'));
        }
        if (cal_days_in_month(CAL_GREGORIAN, date('m'), date('Y')) == 31) {
            $array = array('01' => 0, '02' => 0, '03' => 0, '04' => 0, '05' => 0, '06' => 0, '07' => 0, '08' => 0, '09' => 0, '10' => 0, '11' => 0, '12' => 0, '13' => 0, '14' => 0, '15' => 0, '16' => 0, '17' => 0, '18' => 0, '19' => 0, '20' => 0, '21' => 0, '22' => 0, '23' => 0, '24' => 0, '25' => 0, '26' => 0, '27' => 0, '28' => 0, '29' => 0, '30' => 0, '31' => 0);
        } elseif (cal_days_in_month(CAL_GREGORIAN, date('m'), date('Y')) == 30) {
            $array = array('01' => 0, '02' => 0, '03' => 0, '04' => 0, '05' => 0, '06' => 0, '07' => 0, '08' => 0, '09' => 0, '10' => 0, '11' => 0, '12' => 0, '13' => 0, '14' => 0, '15' => 0, '16' => 0, '17' => 0, '18' => 0, '19' => 0, '20' => 0, '21' => 0, '22' => 0, '23' => 0, '24' => 0, '25' => 0, '26' => 0, '27' => 0, '28' => 0, '29' => 0, '30' => 0);
        } elseif (cal_days_in_month(CAL_GREGORIAN, date('m'), date('Y')) == 29) {
            $array = array('01' => 0, '02' => 0, '03' => 0, '04' => 0, '05' => 0, '06' => 0, '07' => 0, '08' => 0, '09' => 0, '10' => 0, '11' => 0, '12' => 0, '13' => 0, '14' => 0, '15' => 0, '16' => 0, '17' => 0, '18' => 0, '19' => 0, '20' => 0, '21' => 0, '22' => 0, '23' => 0, '24' => 0, '25' => 0, '26' => 0, '27' => 0, '28' => 0, '29' => 0);
        } elseif (cal_days_in_month(CAL_GREGORIAN, date('m'), date('Y')) == 28) {
            $array = array('01' => 0, '02' => 0, '03' => 0, '04' => 0, '05' => 0, '06' => 0, '07' => 0, '08' => 0, '09' => 0, '10' => 0, '11' => 0, '12' => 0, '13' => 0, '14' => 0, '15' => 0, '16' => 0, '17' => 0, '18' => 0, '19' => 0, '20' => 0, '21' => 0, '22' => 0, '23' => 0, '24' => 0, '25' => 0, '26' => 0, '27' => 0, '28' => 0);
        }
        $code = 'd';
        $main_range = 'This Month';
        $title = "Monthly";
    }
}
$start = '';
$end = '';
$first_code = '';
$second_code = '';
if (!empty($_GET['range']) && !in_array($_GET['range'], array('Today', 'Yesterday', 'This Week', 'This Month', 'Last Month', 'This Year'))) {
    $arr = explode('-', $_GET['range']);
    if (preg_match('~(0[1-9]|1[012])[- /.](0[1-9]|[12][0-9]|3[01])[- /.](19|20)\d\d~m', $arr[0]) && preg_match('~(0[1-9]|1[012])[- /.](0[1-9]|[12][0-9]|3[01])[- /.](19|20)\d\d~m', $arr[1])) {
        $start = Wo_Secure($arr[0]);
        $end = Wo_Secure($arr[1]);
        $this_start = strtotime($start);
        $this_end = strtotime($end);
        $month_days = cal_days_in_month(CAL_GREGORIAN, date('m', strtotime($start)), date('Y', strtotime($start)));
        $diff = abs(strtotime($end) - strtotime($start));
        $years = floor($diff / (365 * 60 * 60 * 24));
        $months = floor(($diff - $years * 365 * 60 * 60 * 24) / (30 * 60 * 60 * 24));
        $days = floor(($diff - $years * 365 * 60 * 60 * 24 - $months * 30 * 60 * 60 * 24) / (60 * 60 * 24));
        if ($years >= 1) {
            $array = array();
            for ($i = date('Y', strtotime($start)); $i <= date('Y', strtotime($end)); $i++) {
                $array["'" . $i . "'"] = 0;
            }
            $main_range = 'Custom';
            $code = 'Y';
            $title = "Yearly";
        } elseif ($months >= 1) {
            $array = array('01' => 0, '02' => 0, '03' => 0, '04' => 0, '05' => 0, '06' => 0, '07' => 0, '08' => 0, '09' => 0, '10' => 0, '11' => 0, '12' => 0);
            $code = 'm';
            $main_range = 'This Year';
            $title = "Monthly";
            if (date('Y', strtotime($start)) == date('Y', strtotime($end))) {
                $array = array();
                for ($i = date('m', strtotime($start)); $i <= date('m', strtotime($end)); $i++) {
                    $array["'" . (int)$i . "'"] = 0;
                }
                $code = 'm';
                $main_range = 'Custom';
            } else {
                $month = cal_days_in_month(CAL_GREGORIAN, date('m', strtotime($start)), date('Y', strtotime($start)));
                $array = array();
                for ($i = (int)date('m', strtotime($start)); $i <= 12; $i++) {
                    $array["'" . (int)$i . '-' . date('Y', strtotime($start)) . "'"] = 0;
                }
                for ($i = 1; $i <= (int)date('m', strtotime($end)); $i++) {
                    $array["'" . (int)$i . '-' . date('Y', strtotime($end)) . "'"] = 0;
                }
                $first_code = 'm';
                $second_code = 'Y';
                $main_range = 'Custom';
            }
        } elseif ($days > 7) {
            if (date('m', strtotime($start)) == date('m', strtotime($end))) {
                $array = array();
                for ($i = date('d', strtotime($start)); $i <= date('d', strtotime($end)); $i++) {
                    $array["'" . (int)$i . "'"] = 0;
                }
                $code = 'd';
                $main_range = 'Custom';
            } else {
                $month = cal_days_in_month(CAL_GREGORIAN, date('m', strtotime($start)), date('Y', strtotime($start)));
                $array = array();
                for ($i = (int)date('d', strtotime($start)); $i <= $month; $i++) {
                    $array["'" . (int)$i . '-' . date('m', strtotime($start)) . "'"] = 0;
                }
                for ($i = 1; $i <= (int)date('d', strtotime($end)); $i++) {
                    $array["'" . (int)$i . '-' . date('m', strtotime($end)) . "'"] = 0;
                }
                $first_code = 'd';
                $second_code = 'm';
                $main_range = 'Custom';
            }
            $title = "Daily";
        } elseif ($days >= 1 && $days < 8) {
            $title = "Daily";
            $code = 'l';
            $array = array('Saturday' => 0, 'Sunday' => 0, 'Monday' => 0, 'Tuesday' => 0, 'Wednesday' => 0, 'Thursday' => 0, 'Friday' => 0);
            if (date('m', strtotime($start)) == date('m', strtotime($end))) {
                $array = array();
                for ($i = date('d', strtotime($start)); $i <= date('d', strtotime($end)); $i++) {
                    $array["'" . (int)$i . "'"] = 0;
                }
                $code = 'd';
                $main_range = 'Custom';
            } else {
                $month = cal_days_in_month(CAL_GREGORIAN, date('m', strtotime($start)), date('Y', strtotime($start)));
                $array = array();
                for ($i = (int)date('d', strtotime($start)); $i <= $month; $i++) {
                    $array["'" . (int)$i . '-' . date('m', strtotime($start)) . "'"] = 0;
                }
                for ($i = 1; $i <= (int)date('d', strtotime($end)); $i++) {
                    $array["'" . (int)$i . '-' . date('m', strtotime($end)) . "'"] = 0;
                }
                $first_code = 'd';
                $second_code = 'm';
                $main_range = 'Custom';
            }
        }
    }
}
$users_array = $array;
$posts_array = $array;
$pages_array = $array;
$groups_array = $array;

$users = $db->where('joined', $this_start, '>=')->where('joined', $this_end, '<=')->get(T_USERS, null, array('joined'));
foreach ($users as $key => $value) {
    $day = date($code, $value->joined);
    if ($main_range == 'Custom' && !empty($first_code) && !empty($second_code)) {
        $day = "'" . (int)date($first_code, $value->joined) . '-' . (int)date($second_code, $value->joined) . "'";
    } elseif ($main_range == 'Custom') {
        $day = "'" . (int)date($code, $value->joined) . "'";
    }
    if (in_array($day, array_keys($users_array))) {
        $users_array[$day] += 1;
    }
}
$u_array = implode(', ', $users_array);
$users = array();
$users_array = array();


$posts = $db->where('time', $this_start, '>=')->where('time', $this_end, '<=')->get(T_POSTS, null, array('time'));
foreach ($posts as $key => $value) {
    $day = date($code, $value->time);
    if ($main_range == 'Custom' && !empty($first_code) && !empty($second_code)) {
        $day = "'" . (int)date($first_code, $value->time) . '-' . (int)date($second_code, $value->time) . "'";
    } elseif ($main_range == 'Custom') {
        $day = "'" . (int)date($code, $value->time) . "'";
    }
    if (in_array($day, array_keys($posts_array))) {
        $posts_array[$day] += 1;
    }
}
$p_array = implode(', ', $posts_array);
$posts = array();
$posts_array = array();

$pages = $db->where('time', $this_start, '>=')->where('time', $this_end, '<=')->get(T_PAGES, null, array('time'));
foreach ($pages as $key => $value) {
    $day = date($code, $value->time);
    if ($main_range == 'Custom' && !empty($first_code) && !empty($second_code)) {
        $day = "'" . (int)date($first_code, $value->time) . '-' . (int)date($second_code, $value->time) . "'";
    } elseif ($main_range == 'Custom') {
        $day = "'" . (int)date($code, $value->time) . "'";
    }
    if (in_array($day, array_keys($pages_array))) {
        $pages_array[$day] += 1;
    }
}
$pa_array = implode(', ', $pages_array);
$pages = array();
$pages_array = array();

$groups = $db->where('time', $this_start, '>=')->where('time', $this_end, '<=')->get(T_GROUPS, null, array('time'));
foreach ($groups as $key => $value) {
    $day = date($code, $value->time);
    if ($main_range == 'Custom' && !empty($first_code) && !empty($second_code)) {
        $day = "'" . (int)date($first_code, $value->time) . '-' . (int)date($second_code, $value->time) . "'";
    } elseif ($main_range == 'Custom') {
        $day = "'" . (int)date($code, $value->time) . "'";
    }
    if (in_array($day, array_keys($groups_array))) {
        $groups_array[$day] += 1;
    }
}
$g_array = implode(', ', $groups_array);
$groups = array();
$groups_array = array();




?>
<div class="container-fluid">
    <div>
        <h3>Chào mừng quay trở lại, <?php echo $wo['user']['name']; ?></h3>
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item">
                    <a href="#">Trang chủ</a>
                </li>
                <li class="breadcrumb-item active" aria-current="page">Bảng điều khiển</li>
            </ol>
        </nav>
    </div>
    <!-- Widgets -->
    <?php $getStatus = getStatus();
    if (!empty($getStatus) && !empty(checkIfThereIsError($getStatus))) { ?><div class="alert alert-danger">
            <strong>Quan trọng!</strong> Có một số lỗi được tìm thấy trên hệ thống của bạn, vui lòng xem lại<a href="<?php echo Wo_LoadAdminLinkSettings('system_status'); ?>" data-ajax="?path=system_status">Trạng thái hệ thống</a>.
        </div><?php } ?>
    <div class="row clearfix">
        <div class="col-md-3">
            <div class="card">
                <div class="card-body">
                    <h6 class="card-title">Tổng số người dùng</h6>
                    <div class="d-flex align-items-center mb-3">
                        <div>
                            <div class="avatar">
                                <span class="avatar-title bg-primary-bright text-primary rounded-pill">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m.94 3.198l.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0112 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 016 18.719m12 0a5.971 5.971 0 00-.941-3.197m0 0A5.995 5.995 0 0012 12.75a5.995 5.995 0 00-5.058 2.772m0 0a3 3 0 00-4.681 2.72 8.986 8.986 0 003.74.477m.94-3.197a5.971 5.971 0 00-.94 3.197M15 6.75a3 3 0 11-6 0 3 3 0 016 0zm6 3a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0zm-13.5 0a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z" style="width:24px;height: 24px;" />
                                    </svg>

                                </span>
                            </div>
                        </div>
                        <div class="font-weight-bold ml-1 font-size-30 ml-3">
                            <?php echo number_format(Wo_CountAllData('user')); ?></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card">
                <div class="card-body">
                    <h6 class="card-title">Tổng số bài đăng</h6>
                    <div class="d-flex align-items-center mb-3">
                        <div>
                            <div class="avatar">
                                <span class="avatar-title bg-info-bright text-info rounded-pill">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25zM6.75 12h.008v.008H6.75V12zm0 3h.008v.008H6.75V15zm0 3h.008v.008H6.75V18z" style="width:24px;height: 24px;" />
                                    </svg>

                                </span>
                            </div>
                        </div>
                        <div class="font-weight-bold ml-1 font-size-30 ml-3">
                            <?php echo number_format(Wo_CountAllData('posts')); ?></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card">
                <div class="card-body">
                    <h6 class="card-title">Tổng số trang</h6>
                    <div class="d-flex align-items-center mb-3">
                        <div>
                            <div class="avatar">
                                <span class="avatar-title bg-warning-bright text-warning rounded-pill">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M3 3v1.5M3 21v-6m0 0l2.77-.693a9 9 0 016.208.682l.108.054a9 9 0 006.086.71l3.114-.732a48.524 48.524 0 01-.005-10.499l-3.11.732a9 9 0 01-6.085-.711l-.108-.054a9 9 0 00-6.208-.682L3 4.5M3 15V4.5" style="width:24px;height: 24px;" />
                                    </svg>

                                </span>
                            </div>
                        </div>
                        <div class="font-weight-bold ml-1 font-size-30 ml-3">
                            <?php echo number_format(Wo_CountAllData('page')); ?></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card">
                <div class="card-body">
                    <h6 class="card-title">Tổng số nhóm</h6>
                    <div class="d-flex align-items-center mb-3">
                        <div>
                            <div class="avatar">
                                <span class="avatar-title bg-secondary-bright text-secondary rounded-pill">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m.94 3.198l.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0112 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 016 18.719m12 0a5.971 5.971 0 00-.941-3.197m0 0A5.995 5.995 0 0012 12.75a5.995 5.995 0 00-5.058 2.772m0 0a3 3 0 00-4.681 2.72 8.986 8.986 0 003.74.477m.94-3.197a5.971 5.971 0 00-.94 3.197M15 6.75a3 3 0 11-6 0 3 3 0 016 0zm6 3a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0zm-13.5 0a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z" style="width:24px;height: 24px;" />
                                    </svg>

                                </span>
                            </div>
                        </div>
                        <div class="font-weight-bold ml-1 font-size-30 ml-3">
                            <?php echo number_format(Wo_CountAllData('group')); ?></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card">
                <div class="card-body">
                    <h6 class="card-title">Người dùng đang hoạt động</h6>
                    <div class="d-flex align-items-center mb-3">
                        <div>
                            <div class="avatar">
                                <span class="avatar-title bg-success-bright text-success rounded-pill">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z" style="width:24px;height: 24px;" />
                                    </svg>

                                </span>
                            </div>
                        </div>
                        <div class="font-weight-bold ml-1 font-size-30 ml-3">
                            <?php echo number_format(Wo_CountOnlineData()); ?></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card">
                <div class="card-body">
                    <h6 class="card-title">Tổng số bình luận</h6>
                    <div class="d-flex align-items-center mb-3">
                        <div>
                            <div class="avatar">
                                <span class="avatar-title bg-primary-bright text-primary rounded-pill">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 01-.825-.242m9.345-8.334a2.126 2.126 0 00-.476-.095 48.64 48.64 0 00-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0011.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155" style="width:24px;height: 24px;" />
                                    </svg>

                                </span>
                            </div>
                        </div>
                        <div class="font-weight-bold ml-1 font-size-30 ml-3">
                            <?php echo number_format(Wo_CountAllData('comments')); ?></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card">
                <div class="card-body">
                    <h6 class="card-title">Tổng số ứng dụng hỗ trợ</h6>
                    <div class="d-flex align-items-center mb-3">
                        <div>
                            <div class="avatar">
                                <span class="avatar-title bg-info-bright text-info rounded-pill">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M14.25 6.087c0-.355.186-.676.401-.959.221-.29.349-.634.349-1.003 0-1.036-1.007-1.875-2.25-1.875s-2.25.84-2.25 1.875c0 .369.128.713.349 1.003.215.283.401.604.401.959v0a.64.64 0 01-.657.643 48.39 48.39 0 01-4.163-.3c.186 1.613.293 3.25.315 4.907a.656.656 0 01-.658.663v0c-.355 0-.676-.186-.959-.401a1.647 1.647 0 00-1.003-.349c-1.036 0-1.875 1.007-1.875 2.25s.84 2.25 1.875 2.25c.369 0 .713-.128 1.003-.349.283-.215.604-.401.959-.401v0c.31 0 .555.26.532.57a48.039 48.039 0 01-.642 5.056c1.518.19 3.058.309 4.616.354a.64.64 0 00.657-.643v0c0-.355-.186-.676-.401-.959a1.647 1.647 0 01-.349-1.003c0-1.035 1.008-1.875 2.25-1.875 1.243 0 2.25.84 2.25 1.875 0 .369-.128.713-.349 1.003-.215.283-.4.604-.4.959v0c0 .333.277.599.61.58a48.1 48.1 0 005.427-.63 48.05 48.05 0 00.582-4.717.532.532 0 00-.533-.57v0c-.355 0-.676.186-.959.401-.29.221-.634.349-1.003.349-1.035 0-1.875-1.007-1.875-2.25s.84-2.25 1.875-2.25c.37 0 .713.128 1.003.349.283.215.604.401.96.401v0a.656.656 0 00.658-.663 48.422 48.422 0 00-.37-5.36c-1.886.342-3.81.574-5.766.689a.578.578 0 01-.61-.58v0z" style="width:24px;height: 24px;" />
                                    </svg>

                                </span>
                            </div>
                        </div>
                        <div class="font-weight-bold ml-1 font-size-30 ml-3">
                            <?php echo number_format(Wo_CountAllData('games')); ?></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card">
                <div class="card-body">
                    <h6 class="card-title">Tổng số tin nhắn</h6>
                    <div class="d-flex align-items-center mb-3">
                        <div>
                            <div class="avatar">
                                <span class="avatar-title bg-warning-bright text-warning rounded-pill">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 20.25c4.97 0 9-3.694 9-8.25s-4.03-8.25-9-8.25S3 7.444 3 12c0 2.104.859 4.023 2.273 5.48.432.447.74 1.04.586 1.641a4.483 4.483 0 01-.923 1.785A5.969 5.969 0 006 21c1.282 0 2.47-.402 3.445-1.087.81.22 1.668.337 2.555.337z" style="width:24px;height: 24px;" />
                                    </svg>

                                </span>
                            </div>
                        </div>
                        <div class="font-weight-bold ml-1 font-size-30 ml-3">
                            <?php echo number_format(Wo_CountAllData('messages')); ?></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- #END# Widgets -->
    <div class="row clearfix">
        <!-- Bar Chart -->
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <div class="card">
                <div class="card-body">
                    <h6 class="card-title">Thống kê</h6>
                    <div class="row">
                        <div class="col-md-11"></div>
                        <div class="col-md-1">
                            <div id="dashboard-daterangepicker" class="btn btn-outline-light">
                                <?php
                                if (!empty($_GET['range']) && in_array($_GET['range'], array('Today', 'Yesterday', 'This Week', 'This Month', 'Last Month', 'This Year'))) {
                                    echo $_GET['range'];
                                } else if (!empty($start) && !empty($end)) {
                                    echo $_GET['range'];
                                } else {
                                    echo 'This Year';
                                } ?>
                            </div>
                        </div>
                    </div>
                    <div id="admin-chart-container" style="min-width: 100%; height: 400px; margin: 0 auto;"></div>
                </div>
            </div>
        </div>
        <!-- #END# Bar Chart -->
    </div>
</div>
<script>
    jQuery(document).ready(function($) {
        var range = {
            "Today": [moment(), moment()],
            "Yesterday": [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
            "This_Week": [moment().subtract(6, 'days'), moment()],
            "This_Month": [moment().startOf('month'), moment().endOf('month')],
            "Last_Month": [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf(
                'month')],
            "This_Year": [moment().subtract(1, 'year').startOf('year'), moment().subtract(1, 'year').endOf(
                'year')]
        };
        <?php
        if (!empty($_GET['range']) && in_array($_GET['range'], array('Today', 'Yesterday', 'This Week', 'This Month', 'Last Month', 'This Year'))) {
            if ($_GET['range'] == 'Today') { ?>
                var start = range.Today[0];
                var end = range.Today[1];
            <?php } elseif ($_GET['range'] == 'Yesterday') { ?>
                var start = range.Yesterday[0];
                var end = range.Yesterday[1];
            <?php } elseif ($_GET['range'] == 'This Week') { ?>
                var start = range.This_Week[0];
                var end = range.This_Week[1];
            <?php } elseif ($_GET['range'] == 'This Month') { ?>
                var start = range.This_Month[0];
                var end = range.This_Month[1];
            <?php } elseif ($_GET['range'] == 'Last Month') { ?>
                var start = range.Last_Month[0];
                var end = range.Last_Month[1];
            <?php } elseif ($_GET['range'] == 'This Year') { ?>
                var start = range.This_Year[0];
                var end = range.This_Year[1];
            <?php } ?>
        <?php } elseif (!empty($_GET['range']) && !empty($start) && !empty($end)) { ?>
            var start = "<?php echo ($start) ?>";
            var end = "<?php echo ($end) ?>";
        <?php } else { ?>
            var start = range.This_Year[0];
            var end = range.This_Year[1];
        <?php } ?>

        function cb(start, end) {
            //$('#dashboard-daterangepicker span').html(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));
        }
        $('#dashboard-daterangepicker').daterangepicker({
            startDate: start,
            endDate: end,
            opens: $('body').hasClass('rtl') ? 'right' : 'left',
            ranges: {
                'Today': [moment(), moment()],
                'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
                'This Week': [moment().subtract(6, 'days'), moment()],
                'This Month': [moment().startOf('month'), moment().endOf('month')],
                'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month')
                    .endOf('month')
                ],
                'This Year': [moment().subtract(1, 'year').startOf('year'), moment().subtract(1, 'year')
                    .endOf('year')
                ],
            }
        }, cb);



        cb(start, end);

        // setTimeout(function (argument) {
        //     $('.ranges ul li').removeClass('active');
        // },800);

        $(document).on('click', '.ranges ul li', function(event) {
            event.preventDefault();

            if ($(this).attr('data-range-key') != 'Custom Range') {
                $(document).off('click', '.ranges ul li');
                //location.href = "<?php echo Wo_LoadAdminLinkSettings('dashboard'); ?>?range="+$(this).attr('data-range-key');
                $('#redirect_link').attr('href',
                    "<?php echo Wo_LoadAdminLinkSettings('dashboard'); ?>?range=" + $(this).attr(
                        'data-range-key'));
                $('#redirect_link').attr('data-ajax', "?path=dashboard//range=" + $(this).attr(
                    'data-range-key'));
                $('#redirect_link').click();
            }
        });
        $(document).on('click', '.applyBtn', function(event) {
            event.preventDefault();
            $(document).off('click', '.applyBtn');
            $('#redirect_link').attr('href', "<?php echo Wo_LoadAdminLinkSettings('dashboard'); ?>?range=" +
                $(this).parent('.drp-buttons').find('.drp-selected').html());
            $('#redirect_link').attr('data-ajax', "?path=dashboard//range=" + $(this).parent('.drp-buttons')
                .find('.drp-selected').html());
            $('#redirect_link').click();
            //location.href = "<?php echo Wo_LoadAdminLinkSettings('dashboard'); ?>?range="+$('.drp-selected').html();
        });
        var rgbToHex = function(rgb) {
            var hex = Number(rgb).toString(16);
            if (hex.length < 2) {
                hex = "0" + hex;
            }
            return hex;
        };

        var fullColorHex = function(r, g, b) {
            var red = rgbToHex(r);
            var green = rgbToHex(g);
            var blue = rgbToHex(b);
            return red + green + blue;
        };

        var colors = {
            primary: $('.colors .bg-primary').css('background-color'),
            primaryLight: $('.colors .bg-primary-bright').css('background-color'),
            secondary: $('.colors .bg-secondary').css('background-color'),
            secondaryLight: $('.colors .bg-secondary-bright').css('background-color'),
            info: $('.colors .bg-info').css('background-color'),
            infoLight: $('.colors .bg-info-bright').css('background-color'),
            success: $('.colors .bg-success').css('background-color'),
            successLight: $('.colors .bg-success-bright').css('background-color'),
            danger: $('.colors .bg-danger').css('background-color'),
            dangerLight: $('.colors .bg-danger-bright').css('background-color'),
            warning: $('.colors .bg-warning').css('background-color'),
            warningLight: $('.colors .bg-warning-bright').css('background-color'),
        };
        //console.log(colors.primary[1]);
        colors.primary = '#' + fullColorHex(colors.primary[0], colors.primary[1], colors.primary[2]);
        colors.secondary = '#' + fullColorHex(colors.secondary[0], colors.secondary[1], colors.secondary[2]);
        colors.info = '#' + fullColorHex(colors.info[0], colors.info[1], colors.info[2]);
        colors.success = '#' + fullColorHex(colors.success[0], colors.success[1], colors.success[2]);
        colors.danger = '#' + fullColorHex(colors.danger[0], colors.danger[1], colors.danger[2]);
        colors.warning = '#' + fullColorHex(colors.warning[0], colors.warning[1], colors.warning[2]);
    });



    function users() {
        if ($('#admin-chart-container').length) {
            var options = {
                chart: {
                    type: 'bar',
                    fontFamily: "Inter",
                    offsetX: -26,
                    stacked: false,
                    height: 265,
                    width: '102%',
                    toolbar: {
                        show: false
                    }
                },
                dataLabels: {
                    enabled: false
                },
                series: [{
                    name: 'Users',
                    data: [<?php echo $u_array; ?>]

                }, {
                    name: 'Posts',
                    data: [<?php echo $p_array; ?>]

                }, {
                    name: 'Pages',
                    data: [<?php echo $pa_array; ?>]

                }, {
                    name: 'Groups',
                    data: [<?php echo $g_array; ?>]

                }],
                plotOptions: {
                    bar: {
                        horizontal: false,
                        columnWidth: '50%',
                        endingShape: 'rounded'
                    },
                },
                colors: ['#6abd46', '#ce3d3d', '#f2b92b', '#ff7373'],
                xaxis: {
                    <?php if ($main_range == 'Today' || $main_range == 'Yesterday') { ?>
                        categories: [
                            '00 AM',
                            '1 AM',
                            '2 AM',
                            '3 AM',
                            '4 AM',
                            '5 AM',
                            '6 AM',
                            '7 AM',
                            '8 AM',
                            '9 AM',
                            '10 AM',
                            '11 AM',
                            '12 PM',
                            '1 PM',
                            '2 PM',
                            '3 PM',
                            '4 PM',
                            '5 PM',
                            '6 PM',
                            '7 PM',
                            '8 PM',
                            '9 PM',
                            '10 PM',
                            '11 PM'
                        ]
                    <?php } elseif ($main_range == 'This Week') { ?>
                        categories: [
                            'Saturday',
                            'Sunday',
                            'Monday',
                            'Tuesday',
                            'Wednesday',
                            'Thursday',
                            'Friday'
                        ]
                    <?php } elseif ($main_range == 'This Month') { ?>
                        <?php if ($month_days == 31) { ?>
                            categories: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
                                25, 26, 27, 28, 29, 30, 31
                            ]
                        <?php } elseif ($month_days == 30) { ?>
                            categories: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
                                25, 26, 27, 28, 29, 30
                            ]
                        <?php } elseif ($month_days == 29) { ?>
                            categories: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
                                25, 26, 27, 28, 29
                            ]
                        <?php } elseif ($month_days == 28) {  ?>
                            categories: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
                                25, 26, 27, 28
                            ]
                        <?php } ?>
                    <?php } elseif ($main_range == 'This Year') { ?>
                        categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
                    <?php } elseif ($main_range == 'Custom') {
                        echo "categories: [" . implode(',', array_keys($array)) . "]";
                    } ?>
                },
                tooltip: {
                    y: {
                        formatter: function(val) {
                            return val
                        }
                    }
                }
            };

            var chart = new ApexCharts(
                document.querySelector("#admin-chart-container"),
                options
            );

            chart.render();
        }
    }

    users();
</script>